<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Seapig Viewer</title>

	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
	<script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
	<script src="http://underscorejs.org/underscore-min.js"></script>
	<script src="https://d3js.org/d3.v4.min.js"></script>

	<script language="javascript">
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * json-patch-duplex.js version: 1.1.6
 * (c) 2013 Joachim Wester
 * MIT license
 */
var jsonpatch;if(function(a){function b(a,c){switch(typeof a){case"undefined":case"boolean":case"string":case"number":return a===c;case"object":if(null===a)return null===c;if(z(a)){if(!z(c)||a.length!==c.length)return!1;for(var d=0,e=a.length;d<e;d++)if(!b(a[d],c[d]))return!1;return!0}var f=s(c),g=f.length;if(s(a).length!==g)return!1;for(var d=0;d<g;d++)if(!b(a[d],c[d]))return!1;return!0;default:return!1}}function c(a){return a.indexOf("/")===-1&&a.indexOf("~")===-1?a:a.replace(/~/g,"~0").replace(/\//g,"~1")}function d(a){for(var b=0,c=w.length;b<c;b++)if(w[b].obj===a)return w[b]}function e(a,b){for(var c=0,d=a.observers.length;c<d;c++)if(a.observers[c].callback===b)return a.observers[c].observer}function f(a,b){for(var c=0,d=a.observers.length;c<d;c++)if(a.observers[c].observer===b)return void a.observers.splice(c,1)}function g(a,b){b.unobserve()}function h(a){switch(typeof a){case"object":return JSON.parse(JSON.stringify(a));case"undefined":return null;default:return a}}function i(a,b){var c,g=[],i=d(a);if(i?c=e(i,b):(i=new x(a),w.push(i)),c)return c;if(c={},i.value=h(a),b){c.callback=b,c.next=null;var k=function(){j(c)},l=function(){clearTimeout(c.next),c.next=setTimeout(k)};"undefined"!=typeof window&&(window.addEventListener?(window.addEventListener("mouseup",l),window.addEventListener("keyup",l),window.addEventListener("mousedown",l),window.addEventListener("keydown",l),window.addEventListener("change",l)):(document.documentElement.attachEvent("onmouseup",l),document.documentElement.attachEvent("onkeyup",l),document.documentElement.attachEvent("onmousedown",l),document.documentElement.attachEvent("onkeydown",l),document.documentElement.attachEvent("onchange",l)))}return c.patches=g,c.object=a,c.unobserve=function(){j(c),clearTimeout(c.next),f(i,c),"undefined"!=typeof window&&(window.removeEventListener?(window.removeEventListener("mouseup",l),window.removeEventListener("keyup",l),window.removeEventListener("mousedown",l),window.removeEventListener("keydown",l)):(document.documentElement.detachEvent("onmouseup",l),document.documentElement.detachEvent("onkeyup",l),document.documentElement.detachEvent("onmousedown",l),document.documentElement.detachEvent("onkeydown",l)))},i.observers.push(new y(b,c)),c}function j(a){for(var b,c=0,d=w.length;c<d;c++)if(w[c].obj===a.object){b=w[c];break}k(b.value,a.object,a.patches,""),a.patches.length&&m(b.value,a.patches);var e=a.patches;return e.length>0&&(a.patches=[],a.callback&&a.callback(e)),e}function k(a,b,d,e){"function"==typeof b.toJSON&&(b=b.toJSON());for(var f=s(b),g=s(a),i=!1,j=!1,l=g.length-1;l>=0;l--){var m=g[l],n=a[m];if(!b.hasOwnProperty(m)||void 0===b[m]&&void 0!==n&&z(b)===!1)d.push({op:"remove",path:e+"/"+c(m)}),j=!0;else{var o=b[m];"object"==typeof n&&null!=n&&"object"==typeof o&&null!=o?k(n,o,d,e+"/"+c(m)):n!==o&&(i=!0,d.push({op:"replace",path:e+"/"+c(m),value:h(o)}))}}if(j||f.length!=g.length)for(var l=0;l<f.length;l++){var m=f[l];a.hasOwnProperty(m)||void 0===b[m]||d.push({op:"add",path:e+"/"+c(m),value:h(b[m])})}}function l(a){for(var b,c=0,d=a.length;c<d;){b=a.charCodeAt(c);{if(!(b>=48&&b<=57))return!1;c++}}return!0}function m(a,b,c){for(var d,e,f=[],g=0,h=b.length;g<h;){d=b[g],g++;for(var i=d.path||"",j=i.split("/"),k=a,m=1,n=j.length,o=void 0;;){if(e=j[m],c&&void 0===o&&(void 0===k[e]?o=j.slice(0,m).join("/"):m==n-1&&(o=d.path),void 0!==o&&this.validator(d,g-1,a,o)),m++,void 0===e&&m>=n){f.push(v[d.op].call(d,k,e,a));break}if(z(k)){if("-"===e)e=k.length;else{if(c&&!l(e))throw new A("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",g-1,d.path,d);e=parseInt(e,10)}if(m>=n){if(c&&"add"===d.op&&e>k.length)throw new A("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",g-1,d.path,d);f.push(u[d.op].call(d,k,e,a));break}}else if(e&&e.indexOf("~")!=-1&&(e=e.replace(/~1/g,"/").replace(/~0/g,"~")),m>=n){f.push(t[d.op].call(d,k,e,a));break}k=k[e]}}return f}function n(a,b){var c=[];return k(a,b,c,""),c}function o(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}function p(a){if(void 0===a)return!0;if("array"==typeof a||"object"==typeof a)for(var b in a)if(p(a[b]))return!0;return!1}function q(b,c,d,e){if("object"!=typeof b||null===b||z(b))throw new A("Operation is not an object","OPERATION_NOT_AN_OBJECT",c,b,d);if(!t[b.op])throw new A("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",c,b,d);if("string"!=typeof b.path)throw new A("Operation `path` property is not a string","OPERATION_PATH_INVALID",c,b,d);if(0!==b.path.indexOf("/")&&b.path.length>0)throw new A('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",c,b,d);if(("move"===b.op||"copy"===b.op)&&"string"!=typeof b.from)throw new A("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",c,b,d);if(("add"===b.op||"replace"===b.op||"test"===b.op)&&void 0===b.value)throw new A("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",c,b,d);if(("add"===b.op||"replace"===b.op||"test"===b.op)&&p(b.value))throw new A("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",c,b,d);if(d)if("add"==b.op){var f=b.path.split("/").length,g=e.split("/").length;if(f!==g+1&&f!==g)throw new A("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",c,b,d)}else if("replace"===b.op||"remove"===b.op||"_get"===b.op){if(b.path!==e)throw new A("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",c,b,d)}else if("move"===b.op||"copy"===b.op){var h={op:"_get",path:b.from,value:void 0},i=a.validate([h],d);if(i&&"OPERATION_PATH_UNRESOLVABLE"===i.name)throw new A("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",c,b,d)}}function r(a,b){try{if(!z(a))throw new A("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(b)b=JSON.parse(JSON.stringify(b)),m.call(this,b,a,!0);else for(var c=0;c<a.length;c++)this.validator(a[c],c)}catch(a){if(a instanceof A)return a;throw a}}var s=function(a){if(z(a)){for(var b=new Array(a.length),c=0;c<b.length;c++)b[c]=""+c;return b}if(Object.keys)return Object.keys(a);var b=[];for(var d in a)a.hasOwnProperty(d)&&b.push(d);return b},t={add:function(a,b){a[b]=this.value},remove:function(a,b){var c=a[b];return delete a[b],c},replace:function(a,b){var c=a[b];return a[b]=this.value,c},move:function(a,b,c){var d={op:"_get",path:this.path};m(c,[d]);var e=void 0===d.value?void 0:JSON.parse(JSON.stringify(d.value)),f={op:"_get",path:this.from};return m(c,[f]),m(c,[{op:"remove",path:this.from}]),m(c,[{op:"add",path:this.path,value:f.value}]),e},copy:function(a,b,c){var d={op:"_get",path:this.from};m(c,[d]),m(c,[{op:"add",path:this.path,value:d.value}])},test:function(a,c){return b(a[c],this.value)},_get:function(a,b){this.value=a[b]}},u={add:function(a,b){return a.splice(b,0,this.value),b},remove:function(a,b){var c=a.splice(b,1);return c[0]},replace:function(a,b){var c=a[b];return a[b]=this.value,c},move:t.move,copy:t.copy,test:t.test,_get:t._get},v={add:function(a){v.remove.call(this,a);for(var b in this.value)this.value.hasOwnProperty(b)&&(a[b]=this.value[b])},remove:function(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c],t.remove.call(this,a,c));return b},replace:function(a){var b=m(a,[{op:"remove",path:this.path}]);return m(a,[{op:"add",path:this.path,value:this.value}]),b[0]},move:t.move,copy:t.copy,test:function(a){return JSON.stringify(a)===JSON.stringify(this.value)},_get:function(a){this.value=a}},w=[],x=function(){function a(a){this.observers=[],this.obj=a}return a}(),y=function(){function a(a,b){this.callback=a,this.observer=b}return a}();a.unobserve=g,a.observe=i,a.generate=j;var z;z=Array.isArray?Array.isArray:function(a){return a.push&&"number"==typeof a.length},a.apply=m,a.compare=n;var A=function(a){function b(b,c,d,e,f){a.call(this,b),this.message=b,this.name=c,this.index=d,this.operation=e,this.tree=f}return o(b,a),b}(Error);a.JsonPatchError=A,a.validator=q,a.validate=r}(jsonpatch||(jsonpatch={})),"undefined"!=typeof exports)exports.apply=jsonpatch.apply,exports.observe=jsonpatch.observe,exports.unobserve=jsonpatch.unobserve,exports.generate=jsonpatch.generate,exports.compare=jsonpatch.compare,exports.validate=jsonpatch.validate,exports.validator=jsonpatch.validator,exports.JsonPatchError=jsonpatch.JsonPatchError;else var exports={},isBrowser=!0;Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=jsonpatch,isBrowser&&(exports=void 0);;
new function(){function w(a,d,h,f,g,l){return{tag:a,key:d,attrs:h,children:f,text:g,dom:l,domSize:void 0,state:{},events:void 0,instance:void 0,skip:!1}}function z(a){if(null==a||"string"!==typeof a&&"function"!==typeof a&&"function"!==typeof a.view)throw Error("The selector must be either a string or a component.");if("string"===typeof a&&void 0===H[a]){for(var d,h,f=[],g={};d=O.exec(a);){var l=d[1],k=d[2];""===l&&""!==k?h=k:"#"===l?g.id=k:"."===l?f.push(k):"["===d[3][0]&&((l=d[6])&&(l=l.replace(/\\(["'])/g,
"$1").replace(/\\\\/g,"\\")),"class"===d[4]?f.push(l):g[d[4]]=l||!0)}0<f.length&&(g.className=f.join(" "));H[a]=function(a,d){var l=!1,c,f,n=a.className||a["class"],m;for(m in g)a[m]=g[m];void 0!==n&&(void 0!==a["class"]&&(a["class"]=void 0,a.className=n),void 0!==g.className&&(a.className=g.className+" "+n));for(m in a)if("key"!==m){l=!0;break}Array.isArray(d)&&1==d.length&&null!=d[0]&&"#"===d[0].tag?f=d[0].children:c=d;return w(h||"div",a.key,l?a:void 0,c,f,void 0)}}var m;null==arguments[1]||"object"===
typeof arguments[1]&&void 0===arguments[1].tag&&!Array.isArray(arguments[1])?(m=arguments[1],f=2):f=1;if(arguments.length===f+1)d=Array.isArray(arguments[f])?arguments[f]:[arguments[f]];else for(d=[];f<arguments.length;f++)d.push(arguments[f]);return"string"===typeof a?H[a](m||{},w.normalizeChildren(d)):w(a,m&&m.key,m||{},w.normalizeChildren(d),void 0,void 0)}function P(a){var d=0,h=null,f="function"===typeof requestAnimationFrame?requestAnimationFrame:setTimeout;return function(){var g=Date.now();
0===d||16<=g-d?(d=g,a()):null===h&&(h=f(function(){h=null;a();d=Date.now()},16-(g-d)))}}w.normalize=function(a){return Array.isArray(a)?w("[",void 0,void 0,w.normalizeChildren(a),void 0,void 0):null!=a&&"object"!==typeof a?w("#",void 0,void 0,!1===a?"":a,void 0,void 0):a};w.normalizeChildren=function(a){for(var d=0;d<a.length;d++)a[d]=w.normalize(a[d]);return a};var O=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,H={};z.trust=function(a){null==a&&(a="");return w("<",
void 0,void 0,a,void 0,void 0)};z.fragment=function(a,d){return w("[",a.key,a,w.normalizeChildren(d),void 0,void 0)};var v=function(a){function d(a,c){return function y(d){var k;try{if(!c||null==d||"object"!==typeof d&&"function"!==typeof d||"function"!==typeof(k=d.then))t(function(){c||0!==a.length||console.error("Possible unhandled promise rejection:",d);for(var f=0;f<a.length;f++)a[f](d);g.length=0;l.length=0;n.state=c;n.retry=function(){y(d)}});else{if(d===f)throw new TypeError("Promise can't be resolved w/ itself");
h(k.bind(d))}}catch(Q){m(Q)}}}function h(a){function c(c){return function(a){0<d++||c(a)}}var d=0,f=c(m);try{a(c(k),f)}catch(D){f(D)}}if(!(this instanceof v))throw Error("Promise must be called with `new`");if("function"!==typeof a)throw new TypeError("executor must be a function");var f=this,g=[],l=[],k=d(g,!0),m=d(l,!1),n=f._instance={resolvers:g,rejectors:l},t="function"===typeof setImmediate?setImmediate:setTimeout;h(a)};v.prototype.then=function(a,d){function h(a,d,h,k){d.push(function(c){if("function"!==
typeof a)h(c);else try{g(a(c))}catch(A){l&&l(A)}});"function"===typeof f.retry&&k===f.state&&f.retry()}var f=this._instance,g,l,k=new v(function(a,d){g=a;l=d});h(a,f.resolvers,g,!0);h(d,f.rejectors,l,!1);return k};v.prototype["catch"]=function(a){return this.then(null,a)};v.resolve=function(a){return a instanceof v?a:new v(function(d){d(a)})};v.reject=function(a){return new v(function(d,h){h(a)})};v.all=function(a){return new v(function(d,h){var f=a.length,g=0,l=[];if(0===a.length)d([]);else for(var k=
0;k<a.length;k++)(function(k){function n(a){g++;l[k]=a;g===f&&d(l)}null==a[k]||"object"!==typeof a[k]&&"function"!==typeof a[k]||"function"!==typeof a[k].then?n(a[k]):a[k].then(n,h)})(k)})};v.race=function(a){return new v(function(d,h){for(var f=0;f<a.length;f++)a[f].then(d,h)})};"undefined"!==typeof window?("undefined"===typeof window.Promise&&(window.Promise=v),v=window.Promise):"undefined"!==typeof global&&("undefined"===typeof global.Promise&&(global.Promise=v),v=global.Promise);var F=function(a){function d(a,
f){if(Array.isArray(f))for(var g=0;g<f.length;g++)d(a+"["+g+"]",f[g]);else if("[object Object]"===Object.prototype.toString.call(f))for(g in f)d(a+"["+g+"]",f[g]);else h.push(encodeURIComponent(a)+(null!=f&&""!==f?"="+encodeURIComponent(f):""))}if("[object Object]"!==Object.prototype.toString.call(a))return"";var h=[],f;for(f in a)d(f,a[f]);return h.join("&")},K=function(a,d){function h(){function c(){0===--a&&"function"===typeof x&&x()}var a=0;return function D(d){var f=d.then;d.then=function(){a++;
var g=f.apply(d,arguments);g.then(c,function(d){c();if(0===a)throw d;});return D(g)};return d}}function f(c,a){if("string"===typeof c){var d=c;c=a||{};null==c.url&&(c.url=d)}return c}function g(c,a){if(null==a)return c;for(var d=c.match(/:[^\/]+/gi)||[],f=0;f<d.length;f++){var g=d[f].slice(1);null!=a[g]&&(c=c.replace(d[f],a[g]))}return c}function l(c,a){var d=F(a);if(""!==d){var f=0>c.indexOf("?")?"?":"&";c+=f+d}return c}function k(c){try{return""!==c?JSON.parse(c):null}catch(A){throw Error(c);}}
function m(c){return c.responseText}function n(c,a){if("function"===typeof c)if(Array.isArray(a))for(var d=0;d<a.length;d++)a[d]=new c(a[d]);else return new c(a);return a}var t=0,x;return{request:function(c,x){var t=h();c=f(c,x);var A=new d(function(d,f){null==c.method&&(c.method="GET");c.method=c.method.toUpperCase();var h="boolean"===typeof c.useBody?c.useBody:"GET"!==c.method&&"TRACE"!==c.method;"function"!==typeof c.serialize&&(c.serialize="undefined"!==typeof FormData&&c.data instanceof FormData?
function(a){return a}:JSON.stringify);"function"!==typeof c.deserialize&&(c.deserialize=k);"function"!==typeof c.extract&&(c.extract=m);c.url=g(c.url,c.data);h?c.data=c.serialize(c.data):c.url=l(c.url,c.data);var p=new a.XMLHttpRequest;p.open(c.method,c.url,"boolean"===typeof c.async?c.async:!0,"string"===typeof c.user?c.user:void 0,"string"===typeof c.password?c.password:void 0);c.serialize===JSON.stringify&&h&&p.setRequestHeader("Content-Type","application/json; charset=utf-8");c.deserialize===
k&&p.setRequestHeader("Accept","application/json, text/*");c.withCredentials&&(p.withCredentials=c.withCredentials);for(var x in c.headers)({}).hasOwnProperty.call(c.headers,x)&&p.setRequestHeader(x,c.headers[x]);"function"===typeof c.config&&(p=c.config(p,c)||p);p.onreadystatechange=function(){if(p.status&&4===p.readyState)try{var a=c.extract!==m?c.extract(p,c):c.deserialize(c.extract(p,c));if(200<=p.status&&300>p.status||304===p.status)d(n(c.type,a));else{var q=Error(p.responseText),b;for(b in a)q[b]=
a[b];f(q)}}catch(e){f(e)}};h&&null!=c.data?p.send(c.data):p.send()});return!0===c.background?A:t(A)},jsonp:function(c,k){var m=h();c=f(c,k);var x=new d(function(d,f){var h=c.callbackName||"_mithril_"+Math.round(1E16*Math.random())+"_"+t++,k=a.document.createElement("script");a[h]=function(f){k.parentNode.removeChild(k);d(n(c.type,f));delete a[h]};k.onerror=function(){k.parentNode.removeChild(k);f(Error("JSONP request failed"));delete a[h]};null==c.data&&(c.data={});c.url=g(c.url,c.data);c.data[c.callbackKey||
"callback"]=h;k.src=l(c.url,c.data);a.document.documentElement.appendChild(k)});return!0===c.background?x:m(x)},setCompletionCallback:function(a){x=a}}}(window,v),N=function(a){function d(a,b,e,c,d,f,g){for(;e<c;e++){var q=b[e];null!=q&&h(a,q,d,g,f)}}function h(a,b,c,r,g){var q=b.tag;null!=b.attrs&&v(b.attrs,b,c);if("string"===typeof q)switch(q){case "#":return b.dom=p.createTextNode(b.children),n(a,b.dom,g),b.dom;case "<":return f(a,b,g);case "[":var e=p.createDocumentFragment();null!=b.children&&
(q=b.children,d(e,q,0,q.length,c,null,r));b.dom=e.firstChild;b.domSize=e.childNodes.length;n(a,e,g);return e;default:var k=b.tag;switch(b.tag){case "svg":r="http://www.w3.org/2000/svg";break;case "math":r="http://www.w3.org/1998/Math/MathML"}var l=(q=b.attrs)&&q.is,k=r?l?p.createElementNS(r,k,{is:l}):p.createElementNS(r,k):l?p.createElement(k,{is:l}):p.createElement(k);b.dom=k;if(null!=q)for(e in l=r,q)y(b,e,null,q[e],l);n(a,k,g);null!=b.attrs&&null!=b.attrs.contenteditable?t(b):(null!=b.text&&(""!==
b.text?k.textContent=b.text:b.children=[w("#",void 0,void 0,b.text,void 0,void 0)]),null!=b.children&&(a=b.children,d(k,a,0,a.length,c,null,r),a=b.attrs,"select"===b.tag&&null!=a&&("value"in a&&y(b,"value",null,a.value,void 0),"selectedIndex"in a&&y(b,"selectedIndex",null,a.selectedIndex,void 0))));return k}else{a:{if("function"===typeof b.tag){b.state=null;e=b.tag;if(null!=e.$$reentrantLock$$){b=J;break a}e.$$reentrantLock$$=!0;b.state=null!=b.tag.prototype&&"function"===typeof b.tag.prototype.view?
new b.tag(b):b.tag(b)}else{b.state=Object.create(b.tag);e=b.state.view;if(null!=e.$$reentrantLock$$){b=J;break a}e.$$reentrantLock$$=!0}v(b.state,b,c);b.instance=w.normalize(b.state.view(b));e.$$reentrantLock$$=null;if(null!=b.instance){if(b.instance===b)throw Error("A view cannot return the vnode it received as arguments");c=h(a,b.instance,c,r,g);b.dom=b.instance.dom;b.domSize=null!=b.dom?b.instance.domSize:0;n(a,c,g);b=c}else b.domSize=0,b=J}return b}}function f(a,b,c){var e={caption:"table",thead:"table",
tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"}[(b.children.match(/^\s*?<(\w+)/im)||[])[1]]||"div",e=p.createElement(e);e.innerHTML=b.children;b.dom=e.firstChild;b.domSize=e.childNodes.length;b=p.createDocumentFragment();for(var q;q=e.firstChild;)b.appendChild(q);n(a,b,c);return b}function g(a,b,e,c,f,g,p){if(b!==e&&(null!=b||null!=e))if(null==b)d(a,e,0,e.length,f,g,void 0);else if(null==e)x(b,0,b.length,e);else{if(b.length===e.length){for(var q=!1,r=0;r<e.length;r++)if(null!=
e[r]&&null!=b[r]){q=null==e[r].key&&null==b[r].key;break}if(q){for(r=0;r<b.length;r++)b[r]!==e[r]&&(null==b[r]&&null!=e[r]?h(a,e[r],f,p,m(b,r+1,g)):null==e[r]?x(b,r,r+1,e):l(a,b[r],e[r],f,m(b,r+1,g),c,p));return}}if(!c)a:{if(null!=b.pool&&Math.abs(b.pool.length-e.length)<=Math.abs(b.length-e.length)&&(c=e[0]&&e[0].children&&e[0].children.length||0,Math.abs((b.pool[0]&&b.pool[0].children&&b.pool[0].children.length||0)-c)<=Math.abs((b[0]&&b[0].children&&b[0].children.length||0)-c))){c=!0;break a}c=
!1}if(c){var t=b.pool;b=b.concat(b.pool)}for(var r=q=0,B=b.length-1,A=e.length-1,E;B>=q&&A>=r;){var u=b[q],y=e[r];if(u!==y||c)if(null==u)q++;else if(null==y)r++;else if(u.key===y.key){var C=null!=t&&q>=b.length-t.length||null==t&&c;q++;r++;l(a,u,y,f,m(b,q,g),C,p);c&&u.tag===y.tag&&n(a,k(u),g)}else if(u=b[B],u!==y||c)if(null==u)B--;else if(null==y)r++;else if(u.key===y.key)C=null!=t&&B>=b.length-t.length||null==t&&c,l(a,u,y,f,m(b,B+1,g),C,p),(c||r<A)&&n(a,k(u),m(b,q,g)),B--,r++;else break;else B--,
r++;else q++,r++}for(;B>=q&&A>=r;){u=b[B];y=e[A];if(u!==y||c)if(null==u)B--;else{if(null!=y)if(u.key===y.key)C=null!=t&&B>=b.length-t.length||null==t&&c,l(a,u,y,f,m(b,B+1,g),C,p),c&&u.tag===y.tag&&n(a,k(u),g),null!=u.dom&&(g=u.dom),B--;else{if(!E){E=b;var u=B,C={},v;for(v=0;v<u;v++){var w=E[v];null!=w&&(w=w.key,null!=w&&(C[w]=v))}E=C}null!=y&&(u=E[y.key],null!=u?(C=b[u],l(a,C,y,f,m(b,B+1,g),c,p),n(a,k(C),g),b[u].skip=!0,null!=C.dom&&(g=C.dom)):g=h(a,y,f,void 0,g))}A--}else B--,A--;if(A<r)break}d(a,
e,r,A+1,f,g,p);x(b,q,B+1,e)}}function l(a,b,e,d,n,p,u){var q=b.tag;if(q===e.tag){e.state=b.state;e.events=b.events;var r;var x;null!=e.attrs&&"function"===typeof e.attrs.onbeforeupdate&&(r=e.attrs.onbeforeupdate.call(e.state,e,b));"string"!==typeof e.tag&&"function"===typeof e.state.onbeforeupdate&&(x=e.state.onbeforeupdate(e,b));void 0===r&&void 0===x||r||x?r=!1:(e.dom=b.dom,e.domSize=b.domSize,e.instance=b.instance,r=!0);if(!r)if(null!=e.attrs&&z(e.attrs,e,d,p),"string"===typeof q)switch(q){case "#":b.children.toString()!==
e.children.toString()&&(b.dom.nodeValue=e.children);e.dom=b.dom;break;case "<":b.children!==e.children?(k(b),f(a,e,n)):(e.dom=b.dom,e.domSize=b.domSize);break;case "[":g(a,b.children,e.children,p,d,n,u);b=0;d=e.children;e.dom=null;if(null!=d){for(p=0;p<d.length;p++){var m=d[p];null!=m&&null!=m.dom&&(null==e.dom&&(e.dom=m.dom),b+=m.domSize||1)}1!==b&&(e.domSize=b)}break;default:a=u;n=e.dom=b.dom;switch(e.tag){case "svg":a="http://www.w3.org/2000/svg";break;case "math":a="http://www.w3.org/1998/Math/MathML"}"textarea"===
e.tag&&(null==e.attrs&&(e.attrs={}),null!=e.text&&(e.attrs.value=e.text,e.text=void 0));u=b.attrs;q=e.attrs;r=a;if(null!=q)for(m in q)y(e,m,u&&u[m],q[m],r);if(null!=u)for(m in u)null!=q&&m in q||("className"===m&&(m="class"),"o"!==m[0]||"n"!==m[1]||D(m)?"key"!==m&&e.dom.removeAttribute(m):M(e,m,void 0));null!=e.attrs&&null!=e.attrs.contenteditable?t(e):null!=b.text&&null!=e.text&&""!==e.text?b.text.toString()!==e.text.toString()&&(b.dom.firstChild.nodeValue=e.text):(null!=b.text&&(b.children=[w("#",
void 0,void 0,b.text,void 0,b.dom.firstChild)]),null!=e.text&&(e.children=[w("#",void 0,void 0,e.text,void 0,void 0)]),g(n,b.children,e.children,p,d,null,a))}else e.instance=w.normalize(e.state.view(e)),z(e.state,e,d,p),null!=e.instance?(null==b.instance?h(a,e.instance,d,u,n):l(a,b.instance,e.instance,d,n,p,u),e.dom=e.instance.dom,e.domSize=e.instance.domSize):null!=b.instance?(c(b.instance,null),e.dom=void 0,e.domSize=0):(e.dom=b.dom,e.domSize=b.domSize)}else c(b,null),h(a,e,d,u,n)}function k(a){var b=
a.domSize;if(null!=b||null==a.dom){var c=p.createDocumentFragment();if(0<b){for(a=a.dom;--b;)c.appendChild(a.nextSibling);c.insertBefore(a,c.firstChild)}return c}return a.dom}function m(a,b,c){for(;b<a.length;b++)if(null!=a[b]&&null!=a[b].dom)return a[b].dom;return c}function n(a,b,c){c&&c.parentNode?a.insertBefore(b,c):a.appendChild(b)}function t(a){var b=a.children;if(null!=b&&1===b.length&&"<"===b[0].tag)b=b[0].children,a.dom.innerHTML!==b&&(a.dom.innerHTML=b);else if(null!=a.text||null!=b&&0!==
b.length)throw Error("Child node of a contenteditable must be trusted");}function x(a,b,e,d){for(;b<e;b++){var q=a[b];null!=q&&(q.skip?q.skip=!1:c(q,d))}}function c(a,b){function c(){if(++q===d&&(A(a),a.dom)){var c=a.domSize||1;if(1<c)for(var e=a.dom;--c;){var f=e.nextSibling,g=f.parentNode;null!=g&&g.removeChild(f)}c=a.dom;e=c.parentNode;null!=e&&e.removeChild(c);if(c=null!=b&&null==a.domSize)c=a.attrs,c=!(null!=c&&(c.oncreate||c.onupdate||c.onbeforeremove||c.onremove));c&&"string"===typeof a.tag&&
(b.pool?b.pool.push(a):b.pool=[a])}}var d=1,q=0;if(a.attrs&&a.attrs.onbeforeremove){var f=a.attrs.onbeforeremove.call(a.state,a);null!=f&&"function"===typeof f.then&&(d++,f.then(c,c))}"string"!==typeof a.tag&&a.state.onbeforeremove&&(f=a.state.onbeforeremove(a),null!=f&&"function"===typeof f.then&&(d++,f.then(c,c)));c()}function A(a){a.attrs&&a.attrs.onremove&&a.attrs.onremove.call(a.state,a);if("string"!==typeof a.tag&&a.state.onremove)a.state.onremove(a);if(null!=a.instance)A(a.instance);else if(a=
a.children,Array.isArray(a))for(var b=0;b<a.length;b++){var c=a[b];null!=c&&A(c)}}function y(a,b,c,d,f){var e=a.dom;if("key"!==b&&"is"!==b&&(c!==d||"value"===b||"checked"===b||"selectedIndex"===b||"selected"===b&&a.dom===p.activeElement||"object"===typeof d)&&"undefined"!==typeof d&&!D(b)){var g=b.indexOf(":");if(-1<g&&"xlink"===b.substr(0,g))e.setAttributeNS("http://www.w3.org/1999/xlink",b.slice(g+1),d);else if("o"===b[0]&&"n"===b[1]&&"function"===typeof d)M(a,b,d);else if("style"===b)if(a=c,a===
d&&(e.style.cssText="",a=null),null==d)e.style.cssText="";else if("string"===typeof d)e.style.cssText=d;else{"string"===typeof a&&(e.style.cssText="");for(var q in d)e.style[q]=d[q];if(null!=a&&"string"!==typeof a)for(q in a)q in d||(e.style[q]="")}else b in e&&"href"!==b&&"list"!==b&&"form"!==b&&"width"!==b&&"height"!==b&&void 0===f&&!(a.attrs.is||-1<a.tag.indexOf("-"))?"input"===a.tag&&"value"===b&&a.dom.value==d&&a.dom===p.activeElement||"select"===a.tag&&"value"===b&&a.dom.value==d&&a.dom===p.activeElement||
"option"===a.tag&&"value"===b&&a.dom.value==d||(e[b]=d):"boolean"===typeof d?d?e.setAttribute(b,""):e.removeAttribute(b):e.setAttribute("className"===b?"class":b,d)}}function D(a){return"oninit"===a||"oncreate"===a||"onupdate"===a||"onremove"===a||"onbeforeremove"===a||"onbeforeupdate"===a}function M(a,b,c){var d=a.dom,e="function"!==typeof I?c:function(a){var b=c.call(d,a);I.call(d,a);return b};if(b in d)d[b]="function"===typeof c?e:null;else{var f=b.slice(2);void 0===a.events&&(a.events={});a.events[b]!==
e&&(null!=a.events[b]&&d.removeEventListener(f,a.events[b],!1),"function"===typeof c&&(a.events[b]=e,d.addEventListener(f,a.events[b],!1)))}}function v(a,b,c){"function"===typeof a.oninit&&a.oninit.call(b.state,b);"function"===typeof a.oncreate&&c.push(a.oncreate.bind(b.state,b))}function z(a,b,c,d){d?v(a,b,c):"function"===typeof a.onupdate&&c.push(a.onupdate.bind(b.state,b))}var p=a.document,J=p.createDocumentFragment(),I;return{render:function(a,b){if(!a)throw Error("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");
var c=[],d=p.activeElement;null==a.vnodes&&(a.textContent="");Array.isArray(b)||(b=[b]);g(a,a.vnodes,w.normalizeChildren(b),!1,c,null,void 0);a.vnodes=b;for(var f=0;f<c.length;f++)c[f]();p.activeElement!==d&&d.focus()},setEventCallback:function(a){return I=a}}},G=function(a){function d(a){a=f.indexOf(a);-1<a&&f.splice(a,2)}function h(){for(var a=1;a<f.length;a+=2)f[a]()}a=N(a);a.setEventCallback(function(a){!1!==a.redraw&&h()});var f=[];return{subscribe:function(a,h){d(a);f.push(a,P(h))},unsubscribe:d,
redraw:h,render:a.render}}(window);K.setCompletionCallback(G.redraw);z.mount=function(a){return function(d,h){if(null===h)a.render(d,[]),a.unsubscribe(d);else{if(null==h.view&&"function"!==typeof h)throw Error("m.mount(element, component) expects a component, not a vnode");a.subscribe(d,function(){a.render(d,w(h))});a.redraw()}}}(G);var R=v,L=function(a){if(""===a||null==a)return{};"?"===a.charAt(0)&&(a=a.slice(1));a=a.split("&");for(var d={},h={},f=0;f<a.length;f++){var g=a[f].split("="),l=decodeURIComponent(g[0]),
g=2===g.length?decodeURIComponent(g[1]):"";"true"===g?g=!0:"false"===g&&(g=!1);var k=l.split(/\]\[?|\[/),m=d;-1<l.indexOf("[")&&k.pop();for(var n=0;n<k.length;n++){var l=k[n],t=k[n+1],t=""==t||!isNaN(parseInt(t,10)),x=n===k.length-1;""===l&&(l=k.slice(0,n).join(),null==h[l]&&(h[l]=0),l=h[l]++);null==m[l]&&(m[l]=x?g:t?[]:{});m=m[l]}}return d},S=function(a){function d(d){var f=a.location[d].replace(/(?:%[a-f89][a-f0-9])+/gim,decodeURIComponent);"pathname"===d&&"/"!==f[0]&&(f="/"+f);return f}function h(a){return function(){null==
k&&(k=l(function(){k=null;a()}))}}function f(a,d,f){var c=a.indexOf("?"),g=a.indexOf("#"),k=-1<c?c:-1<g?g:a.length;if(-1<c){var c=L(a.slice(c+1,-1<g?g:a.length)),h;for(h in c)d[h]=c[h]}if(-1<g)for(h in d=L(a.slice(g+1)),d)f[h]=d[h];return a.slice(0,k)}var g="function"===typeof a.history.pushState,l="function"===typeof setImmediate?setImmediate:setTimeout,k,m={prefix:"#!",getPath:function(){switch(m.prefix.charAt(0)){case "#":return d("hash").slice(m.prefix.length);case "?":return d("search").slice(m.prefix.length)+
d("hash");default:return d("pathname").slice(m.prefix.length)+d("search")+d("hash")}},setPath:function(d,h,k){var c={},l={};d=f(d,c,l);if(null!=h){for(var n in h)c[n]=h[n];d=d.replace(/:([^\/]+)/g,function(a,d){delete c[d];return h[d]})}(n=F(c))&&(d+="?"+n);(l=F(l))&&(d+="#"+l);g?(l=k?k.state:null,n=k?k.title:null,a.onpopstate(),k&&k.replace?a.history.replaceState(l,n,m.prefix+d):a.history.pushState(l,n,m.prefix+d)):a.location.href=m.prefix+d},defineRoutes:function(d,k,l){function c(){var c=m.getPath(),
g={},h=f(c,g,g),n=a.history.state;if(null!=n)for(var x in n)g[x]=n[x];for(var t in d)if(n=new RegExp("^"+t.replace(/:[^\/]+?\.{3}/g,"(.*?)").replace(/:[^\/]+/g,"([^\\/]+)")+"/?$"),n.test(h)){h.replace(n,function(){for(var a=t.match(/:[^\/]+/g)||[],f=[].slice.call(arguments,1,-2),h=0;h<a.length;h++)g[a[h].replace(/:|\./g,"")]=decodeURIComponent(f[h]);k(d[t],g,c,t)});return}l(c,g)}g?a.onpopstate=h(c):"#"===m.prefix.charAt(0)&&(a.onhashchange=c);c()}};return m};z.route=function(a,d){var h=S(a),f=function(a){return a},
g,l,k,m,n,t=function(a,c,t){if(null==a)throw Error("Ensure the DOM element that was passed to `m.route` is not undefined");var x=function(){null!=g&&d.render(a,g(w(l,k.key,k)))},v=function(a){if(a!==c)h.setPath(c,null,{replace:!0});else throw Error("Could not resolve default route "+c);};h.defineRoutes(t,function(a,c,d){var h=n=function(a,p){h===n&&(l=null==p||"function"!==typeof p.view&&"function"!==typeof p?"div":p,k=c,m=d,n=null,g=(a.render||f).bind(a),x())};a.view||"function"===typeof a?h({},
a):a.onmatch?R.resolve(a.onmatch(c,d)).then(function(c){h(a,c)},v):h(a,"div")},v);d.subscribe(a,x)};t.set=function(a,c,d){null!=n&&(d={replace:!0});n=null;h.setPath(a,c,d)};t.get=function(){return m};t.prefix=function(a){h.prefix=a};t.link=function(a){a.dom.setAttribute("href",h.prefix+a.attrs.href);a.dom.onclick=function(a){a.ctrlKey||a.metaKey||a.shiftKey||2===a.which||(a.preventDefault(),a.redraw=!1,a=this.getAttribute("href"),0===a.indexOf(h.prefix)&&(a=a.slice(h.prefix.length)),t.set(a,void 0,
void 0))}};t.param=function(a){return"undefined"!==typeof k&&"undefined"!==typeof a?k[a]:k};return t}(window,G);z.withAttr=function(a,d,h){return function(f){d.call(h||this,a in f.currentTarget?f.currentTarget[a]:f.currentTarget.getAttribute(a))}};var T=N(window);z.render=T.render;z.redraw=G.redraw;z.request=K.request;z.jsonp=K.jsonp;z.parseQueryString=L;z.buildQueryString=F;z.version="1.0.1";z.vnode=w;"undefined"!==typeof module?module.exports=z:window.m=z};;
(function(){var t,e,n,o,i=function(t,e){function n(){this.constructor=t}for(var o in e)s.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;this.SeapigClient=function(){function e(t,e){null==e&&(e={}),this.uri=t,this.options=e,this.slave_objects={},this.master_objects={},this.connected=!1,this.socket=void 0,this.error=void 0,this.connect()}return e.prototype.connect=function(){var t;null!=this.socket&&this.disconnect(),this.reconnect_on_close=!0;try{this.socket=new WebSocket(this.uri)}catch(e){return t=e,this.error={while:"connecting",error:t},null!=this.onstatuschange_proc&&this.onstatuschange_proc(this),!1}return this.socket.onopen=function(t){return function(){var e,n,o,i,s,r,c;t.options.debug&&console.log("Connected to seapig server"),t.connected=!0,t.error=null,null!=t.onstatuschange_proc&&t.onstatuschange_proc(t),t.socket.send(JSON.stringify({action:"client-options-set",options:t.options})),s=t.slave_objects;for(o in s)i=s[o],t.socket.send(JSON.stringify({action:"object-consumer-register",pattern:o,"version-known":i.version})),i.validate();r=t.master_objects,c=[];for(o in r)i=r[o],t.socket.send(JSON.stringify({action:"object-producer-register",pattern:o,"version-known":i.version})),o.indexOf("*")>=0?c.push(function(){var t,o;t=i.children,o=[];for(n in t)e=t[n],o.push(e.upload(0,{},e.version,!0));return o}()):c.push(void 0);return c}}(this),this.socket.onclose=this.socket_onclose=function(t){return function(){var e,n,o;t.options.debug&&console.log("Seapig connection closed"),t.connected=!1,t.socket=void 0,o=t.slave_objects;for(e in o)n=o[e],n.invalidate();if(null!=t.onstatuschange_proc&&t.onstatuschange_proc(t),null!=t.reconnection_timer&&clearTimeout(t.reconnection_timer),t.reconnection_timer=null,t.reconnect_on_close)return t.reconnection_timer=setTimeout(function(){return t.reconnection_timer=void 0,t.connect()},2e3)}}(this),this.socket.onerror=function(t){return function(e){return t.options.debug&&console.log("Seapig socket error",e),t.error={while:"connected",error:e}}}(this),this.socket.onmessage=function(t){return function(e){var n,o,i,s,r,c,h;switch(i=JSON.parse(e.data),i.action){case"object-update":r=t.slave_objects;for(o in r)s=r[o],s.matches(i.id)&&s.patch(i);break;case"object-destroy":c=t.slave_objects;for(o in c)s=c[o],s.matches(i.id)&&s.destroy(i.id);h=t.master_objects;for(o in h)s=h[o],s.matches(i.id)&&s.destroy(i.id);break;case"object-produce":n=_.find(_.values(t.master_objects),function(t){return t.matches(i.id)}),!n&&t.options.debug&&console.error('Seapig server submitted invalid "produce" request',i),n&&n.produce(i.id,i["version-inferred"]);break;default:t.options.debug&&console.error("Seapig server submitted an unsupported message",i)}return null}}(this)},e.prototype.disconnect=function(){if(this.reconnect_on_close=!1,null!=this.reconnection_timer&&(clearTimeout(this.reconnection_timer),this.reconnection_timer=null),null!=this.socket)return this.socket.onclose=null,this.socket.close(),this.socket_onclose()},e.prototype.onstatuschange=function(t){return this.onstatuschange_proc=t,this},e.prototype.slave=function(t,e){if(null==e&&(e={}),e.object&&!e.version||!e.object&&e.version)throw"Both or none of 'object' and 'version' are needed";return this.slave_objects[t]=t.indexOf("*")>=0?new o(this,t,e):new n(this,t,e),this.connected&&this.socket.send(JSON.stringify({action:"object-consumer-register",pattern:t,"version-known":this.slave_objects[t].version})),this.slave_objects[t]},e.prototype.master=function(e,n){return null==n&&(n={}),this.master_objects[e]=e.indexOf("*")>=0?new SeapigWildcardMasterObject(this,e,n):new t(this,e,n),this.connected&&this.socket.send(JSON.stringify({action:"object-producer-register",pattern:e,"version-known":this.master_objects[e].version})),this.master_objects[e]},e.prototype.unlink=function(t){if(null!=this.slave_objects[t]&&(delete this.slave_objects[t],this.connected&&this.socket.send(JSON.stringify({action:"object-consumer-unregister",pattern:t}))),null!=this.master_objects[t]&&(delete this.master_objects[t],this.connected))return this.socket.send(JSON.stringify({action:"object-producer-unregister",pattern:t}))},e}(),e=function(){function t(t,e,n){this.client=t,this.id=e,this.destroyed=!1,this.object={},this.ondestroy_proc=void 0,this.onstatuschange_proc=void 0,this.initialized=!!n.object,null!=n.object&&_.extend(this.object,n.object)}return t.prototype.destroy=function(t){if(this.destroyed=!0,null!=this.onstatuschange_proc&&this.onstatuschange_proc(this),null!=this.ondestroy_proc)return this.ondestroy_proc(this)},t.prototype.matches=function(t){return t.match(new RegExp(this.id.replace(/[^A-Za-z0-9*]/g,"\\$&").replace("*",".*?")))},t.prototype.sanitized=function(){return JSON.parse(JSON.stringify(this.object))},t.prototype.ondestroy=function(t){return this.ondestroy_proc=t,this},t.prototype.onstatuschange=function(t){return this.onstatuschange_proc=t,this},t.prototype.unlink=function(){return this.client.unlink(this.id)},t}(),n=function(t){function e(t,n,o){e.__super__.constructor.call(this,t,n,o),this.version=o.version||0,this.valid=!1,this.received_at=null}return i(e,t),e.prototype.onchange=function(t){return this.onchange_proc=t,this},e.prototype.patch=function(t){var e,n,o,i,s;if(this.received_at=new Date,n=JSON.stringify(this.object),t["version-old"]&&0!==t["version-old"]&&null==t.value)_.isEqual(this.version,t["version-old"])||console.error("Seapig lost some updates, this shouldn't ever happen. object:",this.id," version:",this.version," message:",t);else{o=this.object;for(e in o)s=o[e],delete this.object[e]}if(null!=t.value){i=t.value;for(e in i)s=i[e],this.object[e]=s}else jsonpatch.apply(this.object,t.patch);if(this.version=t["version-new"],this.valid=!0,this.initialized=!0,null!=this.onstatuschange_proc&&this.onstatuschange_proc(this),null!=this.onchange_proc&&n!==JSON.stringify(this.object))return this.onchange_proc(this)},e.prototype.validate=function(){if(this.valid=this.initialized,null!=this.onstatuschange_proc)return this.onstatuschange_proc(this)},e.prototype.invalidate=function(){if(this.valid=!1,null!=this.onstatuschange_proc)return this.onstatuschange_proc(this)},e}(e),t=function(t){function e(t,n,o){e.__super__.constructor.call(this,t,n,o),this.version=o.version||[(new Date).getTime(),0],this.shadow=this.sanitized(),this.stall=!1}return i(e,t),e.prototype.onproduce=function(t){return this.onproduce_proc=t,this},e.prototype.set=function(t){var e,n,o;if(null==t&&(t={}),null!=t.version&&(this.version=t.version),null!=t.object){this.stall=!1,n=this.object;for(e in n)o=n[e],delete this.object[e];_.extend(this.object,t.object)}else(t.object===!1||t.stall)&&(this.stall=!0);return this.shadow=this.sanitized(),this.initialized=!0,this.upload(0,{},this.version,!this.stall&&this.shadow)},e.prototype.bump=function(t){var e,n;return null==t&&(t={}),n=this.version,e=this.shadow,this.version=t.version||[n[0],n[1]+1],this.shadow=this.sanitized(),this.initialized=!0,this.upload(n,e,this.version,!this.stall&&this.shadow)},e.prototype.produce=function(t,e){if(null!=this.onproduce_proc)return this.onproduce_proc(this,e);if(!this.initialized)throw"Master object "+t+" has to either be initialized at all times or have an onproduce callback";return this.upload(0,{},this.version,this.shadow)},e.prototype.upload=function(t,e,n,o){var i;return this.client.connected&&(0===t||o===!1||o===!0?this.client.socket.send(JSON.stringify({id:this.id,action:"object-patch","version-new":n,value:o})):(i=jsonpatch.compare(e,o),JSON.stringify(i).length<JSON.stringify(o).length?this.client.socket.send(JSON.stringify({id:this.id,action:"object-patch","version-old":t,"version-new":n,patch:i})):this.client.socket.send(JSON.stringify({id:this.id,action:"object-patch","version-new":n,value:o})))),this},e}(e),o=function(t){function e(t,n,o){e.__super__.constructor.call(this,t,n,o),this.children={}}return i(e,t),e.prototype.patch=function(t){return null==this.children[t.id]&&(this.children[t.id]=new n(this.client,t.id,{}).onchange(this.onchange_proc).onstatuschange(this.onstatuschange_proc).ondestroy(this.ondestroy_proc),this.object[t.id]=this.children[t.id].object),this.children[t.id].patch(t)},e.prototype.destroy=function(t){var e;if(null!=(e=this.children[t]))return delete this.object[t],delete this.children[t],e.destroy(t)},e}(n)}).call(this);
//# sourceMappingURL=seapig-client.min.js.map
(function(){var t,e,n,r,a,s,i,o,c,u,l,g,p,d;c={view:function(t){var e,n,r,a;if(Array.isArray(t.attrs.version)||!t.attrs.version||"number"==typeof t.attrs.version)return m("",JSON.stringify(t.attrs.version,null,2));n=t.attrs.version,r=[];for(e in n)a=n[e],r.push(m("",e+": "+JSON.stringify(a,null,2)));return r}},i={view:function(t){return m("nav.navbar.navbar-toggleable-md.navbar-light.bg-primary.navbar-inverse",m("button.navbar-toggler.navbar-toggler-right",{type:"button","data-toggle":"collapse","data-target":"#navbar-menu","aria-controls":"navbar-menu","aria-expanded":"false","aria-label":"Toggle navigation"},m("span.navbar-toggler-icon")),m("a.navbar-brand",{href:"https://github.com/yunta-mb/seapig-server"},"SeaPig"),"undefined"!=typeof seapig_client&&null!==seapig_client?[m("#navbar-menu.collapse.navbar-collapse",m("ul.navbar-nav.mr-auto",m("li.nav-item"+("statistics"===t.attrs.route&&".active"),m("a.nav-link",{href:"/"+encodeURIComponent(seapig_client.uri)+"/statistics",oncreate:m.route.link},"Statistics")),m("li.nav-item"+("connections"===t.attrs.route&&".active"),m("a.nav-link",{href:"/"+encodeURIComponent(seapig_client.uri)+"/connections",oncreate:m.route.link},"Connections")),m("li.nav-item"+("objects"===t.attrs.route&&".active"),m("a.nav-link",{href:"/"+encodeURIComponent(seapig_client.uri)+"/objects",oncreate:m.route.link},"Objects")),m("li.nav-item"+("observe"===t.attrs.route&&".active"),m("a.nav-link",{href:"/"+encodeURIComponent(seapig_client.uri)+"/observe"+("undefined"!=typeof seapig_object&&null!==seapig_object&&"/"+encodeURIComponent(seapig_object.id)||""),oncreate:m.route.link},"Observe"+("undefined"!=typeof seapig_object&&null!==seapig_object&&":"+seapig_object.id||""))))),m("span.text-white","Server: "+seapig_client.uri),m("button.btn.btn-outline",{onclick:function(){return m.route.set("/")}},"Disconnect")]:void 0)}},s={view:function(t){return m(".col",m.trust("&nbsp;"))}},o={view:function(t){return _.union([m(i)],["undefined"!=typeof seapig_client&&null!==seapig_client&&seapig_client.connected?t.attrs.child():m(".container-flex.mx-auto",m(".card.mx-auto.my-4",{style:{width:"600px"}},m(".card-block",null!=seapig_client.error?"connecting"===seapig_client.error.while?[m("","Couldn't connect to server:"),m("",seapig_client.error.error.toString())]:m("","Connection failed. Reconnecting..."):m("","Connecting to server..."))))],[m(s)])}},r={view:function(t){return[m(i),m(".container-flex.mx-auto",m(".card.mx-auto.my-4",{style:{width:"600px"}},m(".card-block",m("form.m-2.text-center",m("input#server-url.mb-2.mx-auto",{type:"text",placeholder:"SeaPig server URL",style:{width:"500px"}}),m("button.btn.btn-outline.btn-primary.mx-auto",{type:"submit",onclick:function(){return m.route.set("/:server/statistics",{server:encodeURIComponent($("#server-url").val())})}},"Connect"))))),m(s)]}},p={view:function(t){if(seapig_statistics.valid)return m(".container-flex",{style:{width:"95%"},class:"mx-auto"},m(d,{measure:"connections-count",chart:e,name:"Number&nbsp;of connections",aggregate:"last"}),m(d,{measure:"message-outgoing-count",chart:e,name:"Number&nbsp;of outgoing&nbsp;messages",aggregate:"count"}),m(d,{measure:"message-outgoing-size",chart:e,name:"Total&nbsp;size&nbsp;of outgoing&nbsp;messages&nbsp;[B]",aggregate:"sum"}),m(d,{measure:"message-outgoing-size",chart:g,name:"Size&nbsp;of outgoing&nbsp;messages&nbsp;[B]",aggregate:"histogram"}),m(d,{measure:"message-incoming-count",chart:e,name:"Number&nbsp;of incoming&nbsp;messages",aggregate:"count"}),m(d,{measure:"message-incoming-size",chart:e,name:"Total&nbsp;size&nbsp;of incoming&nbsp;messages&nbsp;[B]",aggregate:"sum"}),m(d,{measure:"message-incoming-size",chart:g,name:"Size&nbsp;of incoming&nbsp;messages&nbsp;[B]",aggregate:"histogram"}),m(d,{measure:"message-incoming-processing-time",chart:g,name:"&nbsp Processing&nbsp;time&nbsp;[μs]",aggregate:"histogram"}))}},a={view:function(t){var e,n,r,a,s;if(seapig_connections.valid)return m(".container-flex.mt-3",{style:{width:"95%"},class:"mx-auto"},m(".row.justify-content-md-center",m(".col",m("table.table.table-sm",m("thead",m("tr",m("th","ConnID"),m("th","Client ID"),m("th","Consumes"),m("th","Produces"),m("th","Now producing"))),m("tbody",function(){var t,i,o,c,u;for(o=_.sortBy(_.pairs(seapig_connections.object),function(t){return t[0]}),u=[],t=0,i=o.length;t<i;t++)c=o[t],a=c[0],r=c[1],u.push(function(){var t,i;t=r.clients,i=[];for(n in t)e=t[n],i.push(m("tr",m("td",a),m("th",n),m("td",function(){var t,n,r,a;for(r=_.sortBy(e.consumes),a=[],t=0,n=r.length;t<n;t++)s=r[t],a.push(m("",s));return a}()),m("td",function(){var t,n,r,a;for(r=_.sortBy(e.produces),a=[],t=0,n=r.length;t<n;t++)s=r[t],a.push(m("",s));return a}()),m("td",e.producing?[m("",e.producing[0]),m("",JSON.stringify(e.producing[1]))]:void 0)));return i}());return u}())))))}},u={view:function(t){var e,n,r,a;if(seapig_connections.valid)return m(".container-flex.mt-3",{style:{width:"95%"},class:"mx-auto"},m(".row.justify-content-md-center",m(".col",m("table.table.table-sm",m("thead",m("tr",m("th","Object ID"),m("th",{style:{width:"100px"}},"State"),m("th","Highest Version known"),m("th","Highest Version inferred"),m("th","Consumers"),m("th","Producers"))),m("tbody",function(){var t,s,i,o,u;for(i=_.sortBy(_.pairs(seapig_objects.object)),u=[],t=0,s=i.length;t<s;t++)o=i[t],r=o[0],n=o[1],u.push(m("tr",m("th",m("a",{href:"/"+encodeURIComponent(seapig_client.uri)+"/observe/"+encodeURIComponent(r),oncreate:m.route.link},r)),m("td",n.state.current?"current":n.state.producing?"producing":n.state.enqueued?"enqueued":"waiting for dependencies"),m("td",m(c,{version:n.version_highest_known})),m("td",m(c,{version:n.version_highest_inferred})),m("td",function(){var t,r,a,s;for(a=_.sortBy(n.consumers),s=[],t=0,r=a.length;t<r;t++)e=a[t],s.push(m("",e));return s}()),m("td",function(){var t,e,r,s;for(r=_.sortBy(n.producers),s=[],t=0,e=r.length;t<e;t++)a=r[t],s.push(m("",a));return s}())));return u}())))))}},l={view:function(t){return m(".container-flex.mt-3",{style:{width:"95%"},class:"mx-auto"},m(".row.justify-content-md-center",m(".col",m(".card",m(".card-header.text-center",m("form.form-inline",m(".input-group.mr-sm-2",m(".input-group-addon","Seapig Object ID"),m("input#object-id.form-control",{disabled:"undefined"!=typeof seapig_object&&null!==seapig_object,type:"text",style:{width:"500px"}})),m("button.btn.btn-primary.mr-sm-2",{disabled:"undefined"!=typeof seapig_object&&null!==seapig_object,type:"submit",onclick:function(t){return function(){return m.route.set("/"+encodeURIComponent(seapig_client.uri)+"/observe/:pattern",{pattern:encodeURIComponent($("#object-id").val())}),!1}}(this)},"Subscribe"),m("button.btn.btn-primary",{disabled:"undefined"==typeof seapig_object||null===seapig_object,type:"submit",onclick:function(t){return function(){return m.route.set("/"+encodeURIComponent(seapig_client.uri)+"/observe"),!1}}(this)},"Un-subscribe"))),"undefined"!=typeof seapig_object&&null!==seapig_object?[m(".row.ml-0.mr-0",{style:{"border-bottom":"1px solid rgba(0,0,0,.125)"}},m(".col.col-md-auto.bg-faded.pt-2.pb-1",{style:{width:"150px"}},"Valid"),m(".col.pt-2.pb-1",JSON.stringify(seapig_object.valid))),m(".row.ml-0.pt-0",{style:{"border-bottom":"1px solid rgba(0,0,0,.125)"}},m(".col.col-md-auto.bg-faded.pt-2.pb-1",{style:{width:"150px"}},"Version"),m(".col.pt-2.pb-1",m(c,{version:seapig_object.version}))),m(".row.ml-0.pt-0",{style:{"border-bottom":"1px solid rgba(0,0,0,.125)"}},m(".col.col-md-auto.bg-faded.pt-2.pb-1",{style:{width:"150px"}},"JSON Size"),m(".col.pt-2.pb-1",JSON.stringify(seapig_object.object).length)),m(".row.ml-0.pt-0",m(".col.col-md-auto.bg-faded.pt-2.pb-1",{style:{width:"150px"}},"Object"),m(".col.pt-2.pb-1",m("pre",JSON.stringify(seapig_object.object,null,8))))]:void 0))))},unsubscribe:function(){if("undefined"!=typeof seapig_object&&null!==seapig_object)return seapig_object.unlink(),window.seapig_object=null},subscribe:function(t){return window.seapig_object=seapig_client.slave(t).onstatuschange(function(t){return m.redraw()})},oncreate:function(t){return this.onupdate(t),$("#object-id").val(seapig_object&&seapig_object.id||"")},onupdate:function(t){return null==t.attrs.pattern?this.unsubscribe():seapig_object&&seapig_object.id===t.attrs.pattern?void 0:(this.unsubscribe(),this.subscribe(t.attrs.pattern))}},d={view:function(e){return m(".row",m(".col",{style:{"max-width":"50px","transform-origin":"0 0 0",transform:"rotate(-90deg) translate(-230px,10px)"}},m.trust(e.attrs.name)),m(".col",m(e.attrs.chart,{data:seapig_statistics.object.seconds,measure:e.attrs.measure,aggregate:e.attrs.aggregate}),m(t,{data:seapig_statistics.object.seconds,measure:e.attrs.measure})),m(".col",m(e.attrs.chart,{data:seapig_statistics.object.minutes,measure:e.attrs.measure,aggregate:e.attrs.aggregate}),m(t,{data:seapig_statistics.object.minutes,measure:e.attrs.measure})),m(".col",m(e.attrs.chart,{data:seapig_statistics.object.hours,measure:e.attrs.measure,aggregate:e.attrs.aggregate}),m(t,{data:seapig_statistics.object.hours,measure:e.attrs.measure})),m(".col",m(e.attrs.chart,{data:seapig_statistics.object.days,measure:e.attrs.measure,aggregate:e.attrs.aggregate}),m(t,{data:seapig_statistics.object.days,measure:e.attrs.measure})))}},t={view:function(t){var e;if(e=t.attrs.data.entities[t.attrs.measure])return m("",{style:{"margin-left":"50px"}},null!=_.find(_.pairs(e.metrics),function(t){return t[1].show&&e[t[0]]&&null!=_.last(e[t[0]])})?[m("span","Last "+t.attrs.data.seconds+"s time slot: "),null!=e.last&&null!=_.last(e.last)?m("span",m.trust(" last&nbsp;value&nbsp;=&nbsp;"+_.last(e.last))):void 0,null!=e.count&&null!=_.last(e.count)?m("span",m.trust(" count&nbsp;=&nbsp;"+_.last(e.count))):void 0,null!=e.sum&&null!=_.last(e.sum)?m("span",m.trust(" sum&nbsp;=&nbsp;"+_.last(e.sum))):void 0,null!=e.average&&null!=_.last(e.average)?m("span",m.trust(" average&nbsp;=&nbsp;"+_.last(e.average))):void 0,null!=e.maximum&&null!=_.last(e.maximum)?m("span",m.trust(" maximum&nbsp;=&nbsp;"+_.last(e.maximum))):void 0]:void 0)}},n={view:function(t){return m("",{style:{position:"relative",height:"200px","margin-top":"50px"}},m("canvas",{style:{position:"absolute","background-color":"black"}}),m("svg",{style:{position:"absolute",width:"100%",height:"100%"}},m("g.x-axis"),m("g.y-axis")),m(".chart-tooltip",{style:{position:"absolute"}}))},oncreate:function(t){return this.node=d3.select(t.dom),this.color=function(t){return d3.interpolateViridis(Math.pow(t,.5))},this.onbeforeupdate(t,null)},onbeforeupdate:function(t,e){var n,r,a,s,i,o,c,u,m,l,g,p,d,b,f,h;return g=t.attrs.data.timestamp,g!==this.last_drawn_at&&(this.last_drawn_at=g,o=t.attrs.data.entities[t.attrs.measure],c=t.attrs.data.keep,l=t.attrs.data.seconds,m=50,u=20,s=this.node.node().getBoundingClientRect().height,i=this.node.node().getBoundingClientRect().width,n=s-u,r=i-m,this.node.select("canvas").attr("height",n).attr("width",r).style("left",m+"px"),d=g,p=d-c*l,h=d3.scaleTime().domain([new Date(p-l),new Date(d)]).range([0,r-1]),f=d3.axisBottom(h),this.node.select(".x-axis").attr("transform","translate("+m+","+n+")").call(f),a=this.node.select("canvas").node().getContext("2d"),a.clearRect(0,0,r,n),o[t.attrs.aggregate].length>0&&(a.fillStyle=this.color(0),a.fillRect(b=h(new Date(g-l*o[t.attrs.aggregate].length)),0,h(new Date(g))-b,n)),this.node.select(".y-axis").attr("transform","translate("+m+",0)"),o[t.attrs.aggregate].length>0&&this.draw(g,o,c,l,r,n,h,a,t.attrs.aggregate),!1)}},g=_.extend({},n,{draw:function(t,e,n,r,a,s,i,o){var c,u,m,l,g,p,d,b,f,h,v,w,y,x,j,S,k;for(p=_.max(_.map(e.histogram,function(t){return t.length}))+1,b=function(){var t,n,r;for(r=[],c=t=0,n=p;0<=n?t<=n:t>=n;c=0<=n?++t:--t)r.push(Math.pow(10,1*c/e.metrics.histogram.multiplier));return r}(),d=_.max(_.map(e.histogram,function(t){return _.max(t)})),f=b[p],f<.1&&(f=1),k=d3.scaleLog().domain([f,1]).range([0,s]),S=d3.axisLeft(k).tickSizeOuter([10]).ticks(3).tickFormat(d3.format("2.0s")),this.node.select(".y-axis").call(S),h=e.histogram,v=[],w=l=0,g=h.length;l<g;w=++l)u=h[w],x=i(new Date(t-r*(e.histogram.length-w))),y=i(new Date(t-r*(e.histogram.length-w-1)))-x+1,v.push(function(){var t,e,n;for(n=[],m=t=0,e=p;0<=e?t<=e:t>=e;m=0<=e?++t:--t)u[m]>0?(o.fillStyle=this.color(1*(u[m]||0)/d),n.push(o.fillRect(x,j=k(b[m]),y,k(b[m-1])-j+1))):n.push(void 0);return n}.call(this));return v}}),e=_.extend({},n,{draw:function(t,e,n,r,a,s,i,o,c){var u,m,l,g,p,d,b,f,h,v,w;for(g=_.max(e[c]),w=d3.scaleLinear().domain([g,0]).range([0,s]),v=d3.axisLeft(w).tickSizeOuter([10]).tickFormat(d3.format(".2s")).ticks([7]),this.node.select(".y-axis").call(v),o.fillStyle=this.color(.5),p=e[c],d=[],b=m=0,l=p.length;m<l;b=++m)u=p[b],d.push(o.fillRect(f=i(new Date(t-r*(e[c].length-b))),h=w(u),i(new Date(t-r*(e[c].length-b-1)))-f+1,w(0)-h-1));return d}}),$(document).ready(function(t){return function(){var e,n;return e=function(e){if(null==t.seapig_client)return t.seapig_client=new SeapigClient(e,{name:"web-viewer",debug:!0}).onstatuschange(function(t){return m.redraw()}),t.seapig_statistics=t.seapig_client.slave("SeapigServer::Statistics").onchange(function(t){return m.redraw()}),t.seapig_connections=t.seapig_client.slave("SeapigServer::Connections").onchange(function(t){return m.redraw()}),t.seapig_objects=t.seapig_client.slave("SeapigServer::Objects").onstatuschange(function(t){return m.redraw()}),t.seapig_object=null},n=function(){if(null!=t.seapig_client)return t.seapig_client.disconnect(),t.seapig_client=null},m.route(document.body,"/",{"/":{view:function(){return m(r)},oninit:function(t){return n()}},"/:server/statistics":{view:function(){return m(o,{child:function(t){return function(){return m(p)}}(this)})},oninit:function(t){return e(t.attrs.server)}},"/:server/connections":{view:function(){return m(o,{child:function(t){return function(){return m(a)}}(this)})},oninit:function(t){return e(t.attrs.server)}},"/:server/objects":{view:function(){return m(o,{child:function(t){return function(){return m(u)}}(this)})},oninit:function(t){return e(t.attrs.server)}},"/:server/observe":{view:function(){return m(o,{child:function(t){return function(){return m(l)}}(this)})},oninit:function(t){return e(t.attrs.server)}},"/:server/observe/:pattern":{view:function(t){return m(o,{child:function(e){return function(){return m(l,{pattern:t.attrs.pattern})}}(this)})},oninit:function(t){return e(t.attrs.server)}}})}}(this))}).call(this);
//# sourceMappingURL=seapig-viewer.min.js.map
	</script>
</head>
<body>
</body>
</html>
